t1=0; t2=1; t3=2;t4=3; t5=4; t6=5; t7=6; t8=7; t9=8; t10=9; t11=10;
t12=11; t13=12; t14=13; t15=14; t16=15; t17=16; t18=17; t19=18; t20=19;
t21=20; t22=21; t23=22; t24=23; t25=24; t26=25; t27=26; t28=27; 
A1=[t1.^3 t1.^2 t1 1 ; t2.^3 t2.^2 t2 1 ; 3.*t1.^2 2.*t1 1 0; 3.*t2.^2 2.*t2 1 0] ;
A2=[t2.^3 t2.^2 t2 1 ; t3.^3 t3.^2 t3 1 ; 3.*t2.^2 2.*t2 1 0; 3.*t3.^2 2.*t3 1 0];
A3=[t3.^3 t3.^2 t3 1 ; t4.^3 t4.^2 t4 1 ; 3.*t3.^2 2.*t3 1 0; 3.*t4.^2 2.*t4 1 0];
A4=[t4.^3 t4.^2 t4 1 ; t5.^3 t5.^2 t5 1 ; 3.*t4.^2 2.*t4 1 0; 3.*t5.^2 2.*t5 1 0];
A5=[t5.^3 t5.^2 t5 1 ; t6.^3 t6.^2 t6 1 ; 3.*t5.^2 2.*t5 1 0; 3.*t6.^2 2.*t6 1 0];
A6=[t6.^3 t6.^2 t6 1 ; t7.^3 t7.^2 t7 1 ; 3.*t6.^2 2.*t6 1 0; 3.*t7.^2 2.*t7 1 0];
A7=[t7.^3 t7.^2 t7 1 ; t8.^3 t8.^2 t8 1 ; 3.*t7.^2 2.*t7 1 0; 3.*t8.^2 2.*t8 1 0];
A8=[t8.^3 t8.^2 t8 1 ; t9.^3 t9.^2 t9 1 ; 3.*t8.^2 2.*t8 1 0 ;3.*t9.^2 2.*t9 1 0];
A9=[t9.^3 t9.^2 t9 1 ; t10.^3 t10.^2 t10 1 ; 3.*t9.^2 2.*t9 1 0; 3.*t10.^2 2.*t10 1 0];
A10=[t10.^3 t10.^2 t10 1 ; t11.^3 t11.^2 t11 1 ; 3.*t10.^2 2.*t10 1 0 ; 3.*t11.^2 2.*t11 1 0];
A11=[t11.^3 t11.^2 t11 1 ; t12.^3 t12.^2 t12 1 ; 3.*t11.^2 2.*t11 1 0 ; 3.*t12.^2 2.*t12 1 0];
A12=[t12.^3 t12.^2 t12 1 ; t13.^3 t13.^2 t13 1 ; 3.*t12.^2 2.*t12 1 0 ; 3.*t13.^2 2.*t13 1 0];
A13=[t13.^3 t13.^2 t13 1 ; t14.^3 t14.^2 t14 1 ; 3.*t13.^2 2.*t13 1 0 ; 3.*t14.^2 2.*t14 1 0];
A14=[t14.^3 t14.^2 t14 1 ; t15.^3 t15.^2 t15 1 ; 3.*t14.^2 2.*t14 1 0 ; 3.*t15.^2 2.*t15 1 0];
A15=[t15.^3 t15.^2 t15 1 ; t16.^3 t16.^2 t16 1 ; 3.*t15.^2 2.*t15 1 0 ; 3.*t16.^2 2.*t16 1 0];
A16=[t16.^3 t16.^2 t16 1 ; t17.^3 t17.^2 t17 1 ; 3.*t16.^2 2.*t16 1 0 ; 3.*t17.^2 2.*t17 1 0];
A17=[t17.^3 t17.^2 t17 1 ; t18.^3 t18.^2 t18 1 ; 3.*t17.^2 2.*t17 1 0 ; 3.*t18.^2 2.*t18 1 0];
A18=[t18.^3 t18.^2 t18 1 ; t19.^3 t19.^2 t19 1 ; 3.*t18.^2 2.*t18 1 0 ; 3.*t19.^2 2.*t19 1 0];
A19=[t19.^3 t19.^2 t19 1 ; t20.^3 t20.^2 t20 1 ; 3.*t19.^2 2.*t19 1 0 ; 3.*t20.^2 2.*t20 1 0];
A20=[t20.^3 t20.^2 t20 1 ; t21.^3 t21.^2 t21 1 ; 3.*t20.^2 2.*t20 1 0 ; 3.*t21.^2 2.*t21 1 0];
A21=[t21.^3 t21.^2 t21 1 ; t22.^3 t22.^2 t22 1 ; 3.*t21.^2 2.*t21 1 0 ; 3.*t22.^2 2.*t22 1 0];
A22=[t22.^3 t22.^2 t22 1 ; t23.^3 t23.^2 t23 1 ; 3.*t22.^2 2.*t22 1 0 ; 3.*t23.^2 2.*t23 1 0];
A23=[t23.^3 t23.^2 t23 1 ; t24.^3 t24.^2 t24 1 ; 3.*t23.^2 2.*t23 1 0 ; 3.*t24.^2 2.*t24 1 0];
A24=[t24.^3 t24.^2 t24 1 ; t25.^3 t25.^2 t25 1 ; 3.*t24.^2 2.*t24 1 0 ; 3.*t25.^2 2.*t25 1 0];
A25=[t25.^3 t25.^2 t25 1 ; t26.^3 t26.^2 t26 1 ; 3.*t25.^2 2.*t25 1 0 ; 3.*t26.^2 2.*t26 1 0];
A26=[t26.^3 t26.^2 t26 1 ; t27.^3 t27.^2 t27 1 ; 3.*t26.^2 2.*t26 1 0 ; 3.*t27.^2 2.*t27 1 0];
A27=[t27.^3 t27.^2 t27 1 ; t28.^3 t28.^2 t28 1 ; 3.*t27.^2 2.*t27 1 0 ; 3.*t28.^2 2.*t28 1 0];
%q6
B1= [-2.51171;-1.87129;0.058405;0];
B2= [-1.87129;-2.3949;0;0.261805];
B3= [-2.3949;-1.87129;0.261805;-0.32021];
B4= [-1.87129;-1.87129;-0.32021;-0.32021];
B5= [-1.87129;-2.51171;-0.32021;0];
B6= [-2.51171;-2.51171;0;0];
B7= [-2.51171;-2.51171;0;0];
B8= [-2.51171;-2.51171;0;0];
B9= [-2.51171;-2.51171;0;0];
B10= [-2.51171;-2.51171;0;0];
B11= [-2.51171;-2.51171;0;0];
B12= [-2.51171;-2.51171;0;0];
B13= [-2.51171;-2.51171;0;0];
B14= [-2.51171;-2.51171;0;-0.17259];
B15= [-2.51171;-2.51171;-0.17259;0];
B16= [-2.51171;-2.8569;0;0];
B17= [-2.8569;-2.51171;-0.17259;0];
B18= [-2.51171;-2.51171;-0.07853;0];
B19= [-2.51171;-2.51171;0;0];
B20= [-2.51171;-2.51171;0;0];
B21= [-2.51171;-2.51171;0;0];
B22= [-2.51171;-2.51171;0;0];
B23= [-2.51171;-2.51171;0;0];
B24= [-2.51171;-2.51171;0;0];
B25= [-2.51171;-2.51171;0;0];
B26= [-2.51171;-2.51171;0;0];
B27= [-2.51171;-2.51171;0;0];

X1= inv(A1)*B1;
X2= inv(A2)*B2;
X3= inv(A3)*B3;
X4= inv(A4)*B4;
X5= inv(A5)*B5;
X6= inv(A6)*B6;
X7= inv(A7)*B7;
X8=inv(A8)*B8;
X9=inv(A9)*B9;
X10=inv(A10)*B10;
X11=inv(A11)*B11;
X12=inv(A12)*B12;
X13=inv(A13)*B13;
X14=inv(A14)*B14;
X15=inv(A15)*B15;
X16=inv(A16)*B16;
X17=inv(A17)*B17;
X18=inv(A18)*B18;
X19=inv(A19)*B19;
X20=inv(A20)*B20;
X21=inv(A21)*B21;
X22=inv(A22)*B22;
X23=inv(A23)*B23;
X24=inv(A24)*B24;
X25=inv(A25)*B25;
X26=inv(A26)*B26;
X27=inv(A27)*B27;

T1=0:0.01:1;
T2=1:0.01:2;
T3=2:0.01:3;
T4=3:0.01:4;
T5=4:0.01:5; 
T6=5:0.01:6;
T7=6:0.01:7;
T8=7:0.01:8;
T9=8:0.01:9;
T10=9:0.01:10;
T11=10:0.01:11;
T12=11:0.01:12;
T13=12:0.01:13;
T14=13:0.01:14;
T15=14:0.01:15;
T16=15:0.01:16;
T17=16:0.01:17;
T18=17:0.01:18;
T19=18:0.01:19;
T20=19:0.01:20;
T21=20:0.01:21;
T22=21:0.01:22;
T23=22:0.01:23;
T24=23:0.01:24;
T25=24:0.01:25;
T26=25:0.01:26;
T27=26:0.01:27;

u1=X1(1).*T1.^3 +X1(2).*T1.^2+ X1(3).*T1 +X1(4);
u2=X2(1).*T2.^3 +X2(2).*T2.^2+ X2(3).*T2 +X2(4);
u3=X3(1).*T3.^3 +X3(2).*T3.^2+ X3(3).*T3 +X3(4);
u4=X4(1).*T4.^3 +X4(2).*T4.^2 +X4(3).*T4 +X4(4);
u5=X5(1).*T5.^3 +X5(2).*T5.^2 +X5(3).*T5 +X5(4);
u6=X6(1).*T6.^3 +X6(2).*T6.^2 +X6(3).*T6 +X6(4);
u7=X7(1).*T7.^ 3+X7(2).*T7.^2 +X7(3).*T7 +X7(4);
u8=X8(1).*T8.^3+X8(2).*T8.^2+X8(3).*T8+X8(4);
u9=X9(1).*T9.^3+X9(2).*T9.^2+X9(3).*T9+X9(4);
u10=X10(1).*T10.^3+X10(2).*T10.^2+X10(3).*T10+X10(4);
u11=X11(1).*T11.^3+X11(2).*T11.^2+X11(3).*T11+X11(4);
u12=X12(1).*T12.^3+X12(2).*T12.^2+X12(3).*T12+X12(4);
u13=X13(1).*T13.^3+X13(2).*T13.^2+X13(3).*T13+X13(4);
u14=X14(1).*T14.^3+X14(2).*T14.^2+X14(3).*T14+X14(4);
u15=X15(1).*T15.^3+X15(2).*T15.^2+X15(3).*T15+X15(4);
u16=X16(1).*T16.^3+X16(2).*T16.^2+X16(3).*T16+X16(4);
u17=X17(1).*T17.^3+X17(2).*T17.^2+X17(3).*T17+X17(4);
u18=X18(1).*T18.^3+X18(2).*T18.^2+X18(3).*T18+X18(4);
u19=X19(1).*T19.^3+X19(2).*T19.^2+X19(3).*T19+X19(4);
u20=X20(1).*T20.^3+X20(2).*T20.^2+X20(3).*T20+X20(4);
u21=X21(1).*T21.^3+X21(2).*T21.^2+X21(3).*T21+X21(4);
u22=X22(1).*T22.^3+X22(2).*T22.^2+X22(3).*T22+X22(4);
u23=X23(1).*T23.^3+X23(2).*T23.^2+X23(3).*T23+X23(4);
u24=X24(1).*T24.^3+X24(2).*T24.^2+X24(3).*T24+X24(4);
u25=X25(1).*T25.^3+X25(2).*T25.^2+X25(3).*T25+X25(4);
u26=X26(1).*T26.^3+X26(2).*T26.^2+X26(3).*T26+X26(4);
u27=X27(1).*T27.^3+X27(2).*T27.^2+X27(3).*T27+X27(4);

title('quy dao bien khop q5')
xlabel('thoi gian(s)')
ylabel('radian')
hold on
grid on
plot (T1,u1,'linewidth',2)
plot (T2,u2,'linewidth',2)
plot (T3,u3,'linewidth',2)
plot (T4,u4,'linewidth',2)
plot (T5,u5,'linewidth',2)
plot (T6,u6,'linewidth',2)
plot (T7,u7,'linewidth',2)
plot(T8,u8,'linewidth',2)
plot(T9,u9,'linewidth',2)
plot(T10,u10,'linewidth',2)
plot(T11,u11,'linewidth',2)
plot(T12,u12,'linewidth',2)
plot(T13,u13,'linewidth',2)
plot(T14,u14,'linewidth',2)
plot(T15,u15,'linewidth',2)
plot(T16,u16,'linewidth',2)
plot(T17,u17,'linewidth',2)
plot(T18,u18,'linewidth',2)
plot(T19,u19,'linewidth',2)
plot(T20,u20,'linewidth',2)
plot(T21,u21,'linewidth',2)
plot(T22,u22,'linewidth',2)
plot(T23,u23,'linewidth',2)
plot(T24,u24,'linewidth',2)
plot(T25,u25,'linewidth',2)
plot(T26,u26,'linewidth',2)
plot(T27,u27,'linewidth',2)
